@{
	ViewBag.Title = "新建服装设计";
}

@section head{
	<script type="text/javascript" src="~/Static/Resources/_references.js"></script>
	<link rel="stylesheet" href="~/Static/Resources/site/DesignTShirt_Create.css" />
}

<div class="left">
	<div id="TShirtTypeAndColor" class="group">
		<div id="TShirtType">
			<span id="_ShortRNeck" style="background-image: url('/Static/SystemFiles/TShirt/ShortRNeck/50x50.png')" title="短袖圆领" class="button active"></span>
			<span id="_ShortVNeck" style="background-image: url('/Static/SystemFiles/TShirt/ShortVNeck/50x50.png')" title="短袖V领" class="button"></span>
			<span id="_LongRNeck" style="background-image: url('/Static/SystemFiles/TShirt/LongRNeck/50x50.png')" title="长袖圆领" class="button"></span>
			<span id="_LongVNeck" style="background-image: url('/Static/SystemFiles/TShirt/LongVNeck/50x50.png')" title="长袖V领" class="button"></span>
		</div>
		<div id="TShirtColor">
			<span id="_ColorGUID1" style="background-color: #ffffff;" class="button active"></span>
			<span id="_ColorGUID2" style="background-color: #000000;" class="button"></span>
			<span id="_ColorGUID3" style="background-color: #ff0000;" class="button"></span>
			<span id="_ColorGUID4" style="background-color: #00ff00;" class="button"></span>
			<span id="_ColorGUID5" style="background-color: #0000ff;" class="button"></span>
		</div>
	</div>
	<div id="UploadImage" class="group">
	</div>
</div>
<div class="main">
	<div id="ShowEffect" class="group">
		<div id="_PictureGUID1" style="position: relative; width: 550px; height: 650px;">
			<div id="_PictureGUID1_upload" class="uploadImage" style="width:240px; height:320px; left:155px; top:165px;"></div>
		</div>
		<div id="_PictureGUID2" style="position: relative; width: 550px; height: 650px;">
			<div id="_PictureGUID2_upload" class="uploadImage" style="width:240px; height:320px; left:155px; top:165px;"></div>
		</div>
	</div>
</div>

@section scripts{
	<script type="text/javascript">
		var CurrentTShirtType = "ShortRNeck";
		var CurrentTShirtColor = "ffffff";

		var DataTShirtType =  @Html.Raw(ViewBag.DataTShirtType) ;

		$(function ()
		{
			//#region 初始化单选事件
			$("#TShirtType > span").live("mouseover", function () { $(this).addClass("hover"); });
			$("#TShirtType > span").live("mouseout", function () { $(this).removeClass("hover"); });
			$("#TShirtType > span").live("click", function ()
			{
				$("#TShirtType > span.active").removeClass("active");
				$(this).addClass("active");
				CurrentTShirtType = $(this).attr("id").substring(1);

				OnTypeChange();
			});

			$("#TShirtColor > span").live("mouseover", function () { $(this).addClass("hover"); });
			$("#TShirtColor > span").live("mouseout", function () { $(this).removeClass("hover"); });
			$("#TShirtColor > span").live("click", function ()
			{
				$("#TShirtColor > span.active").removeClass("active");
				$(this).addClass("active");
				CurrentTShirtColor = $(this).attr("id").substring(1);

				OnColorChange();
			});

			$("#ShowEffect .uploadImage").live("mouseover", function () { $(this).css("border-color","#ccc"); });
			$("#ShowEffect .uploadImage").live("mouseout", function () { $(this).css("border-color","transparent"); });
			//#endregion

			UpdateTShirtType();

			UpdateTShirtColor();
		});

		function UpdateTShirtType()
		{
			$("#TShirtType").empty();
			for (var i = 0; i < DataTShirtType.length; i++)
			{
				var activeClass = "";
				if (i == 0)
				{
					activeClass = " active";
					CurrentTShirtType = DataTShirtType[i].GUID;
				}
				var tempspan = String.format('<span id="_{0}" style="background-image: url(\'/Static/SystemFiles/{1}/{0}/50x50.png\')" title="{2}" class="button{3}"></span>',
					DataTShirtType[i].GUID, DataTShirtType[i].TypeID, DataTShirtType[i].Name, activeClass);
				$("#TShirtType").append(tempspan);
			}
		}

		function UpdateTShirtColor()
		{
			$("#TShirtColor").empty();
			var CurrentMaterialcolors = [];

			//#region 查找到当前的 CurrentMaterialcolors
			for (var i = 0; i < DataTShirtType.length; i++)
			{
				if (DataTShirtType[i].GUID == CurrentTShirtType)
				{
					CurrentMaterialcolors = DataTShirtType[i].materialcolors;
					break;
				}
			}
			//#endregion

			for (var i = 0; i < CurrentMaterialcolors.length; i++)
			{
				var activeClass = "";
				if (CurrentMaterialcolors[i].IsDefault)
				{
					activeClass = " active";
					CurrentTShirtColor = CurrentMaterialcolors[i].ColorCode;
				}
				var tempspan = String.format('<span id="_{0}" style="background-color:#{1};" title="{2}" class="button{3}"></span>',
					CurrentMaterialcolors[i].GUID, CurrentMaterialcolors[i].ColorCode, CurrentMaterialcolors[i].ColorName, activeClass);
				$("#TShirtColor").append(tempspan);
			}
		}

		function UpdataShowEffect()
		{
			$("#ShowEffect").empty();
			var CurrentMaterialpictures = [];

			//#region 查找到当前的 CurrentMaterialpictures
			for (var i = 0; i < DataTShirtType.length; i++)
			{
				if (DataTShirtType[i].GUID == CurrentTShirtType)
				{
					CurrentMaterialpictures = DataTShirtType[i].materialpictures;
					break;
				}
			}
			//#endregion

			for (var i = 0; i < CurrentMaterialpictures.length; i++)
			{
				var activeClass = "";
				if (CurrentMaterialcolors[i].IsDefault)
				{
					activeClass = " active";
					CurrentTShirtColor = CurrentMaterialcolors[i].ColorCode;
				}
				var tempspan = String.format('<span id="_{0}" style="background-color:#{1};" title="{2}" class="button{3}"></span>',
					CurrentMaterialcolors[i].GUID, CurrentMaterialcolors[i].ColorCode, CurrentMaterialcolors[i].ColorName, activeClass);
				$("#TShirtColor").append(tempspan);
			}
		}

		function OnTypeChange()
		{
			UpdateTShirtColor();

			UpdataShowEffect();
		}

		function OnColorChange()
		{
		}

	</script>

}